# Mobile Wallets

Open Lavatory is implemented to be as platform agnostic as possible.

To use openlv in react-native you can use the `@openlv/react-native` package.
This package wraps `@openlv/session` packing a provider and the necessary polyfills.


## Installation

:::code-group

```bash [npm]
npm install @openlv/react-native @openlv/transport
```

```bash [pnpm]
pnpm install @openlv/react-native @openlv/transport
```

```bash [yarn]
yarn add @openlv/react-native @openlv/transport
```

```bash [bun]
bun install @openlv/react-native @openlv/transport
```

:::

## Example

```tsx [App.tsx]
import React from 'react';
import { View, Text, Button } from 'react-native';
import { OpenLVGlobals, connectSession } from '@openlv/react-native'; // [!code ++]
import { webrtc } from '@openlv/transport/webrtc'; // [!code ++]

export default function App() {
  const [connected, setConnected] = React.useState(false)

  const startSession = async () => {
    const session = await connectSession( // [!code ++]
      'openlv://...', // [!code ++]
      async (message) => { // [!code ++]
        // Handle incoming RPC-like requests from dApp peer // [!code ++]
        return { result: 'ok' } // [!code ++]
      }, // [!code ++]
      webrtc(), // [!code ++]
    ); // [!code ++]

    await session.connect();
    await session.waitForLink();
    setConnected(true);
  }

  return (
    <>
      <OpenLVGlobals />
      <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center' }}>
        <Text>OpenLV Mobile Wallet</Text>
        <Button title='Start Session' onPress={startSession} />
        {connected && <Text>Session Connected</Text>}
      </View>
    </>
  )
};
```

This example demonstrates how to:

- Set up a basic mobile wallet
- Connect to dApps using the OpenLV protocol
- Handle incoming requests from dApps via the `connectSession` function

The `OpenLVGlobals` component sets up global polyfills and provides the necessary environment for OpenLV functionality.

### Global Setup

The `OpenLVGlobals` component comes bundled with several polyfills to ensure compatibility:
- `react-native-webrtc`
- `react-native-webview-crypto`
- `react-native-get-random-values`

These polyfills override certain global objects (e.g., `window.crypto`), and are installed only once and cleaned up when the runtime is unmounted.

## Mobile Platform Considerations

:::note

Due to the nature of how the openlv protocol works, a persistent connection is required for transport.
Thus, it is required to keep the wallet open in order to interact with a dApp.

:::

### Future Considerations

As a result of the above, the mobile wallet paired with mobile-dapp experience is not ideal.
This is something we are working to address, however due to how phones operate would this would require services such as [APN](https://developer.apple.com/documentation/usernotifications), [FCM](https://firebase.google.com/docs/cloud-messaging/android/client).

A potential approach to circumvent this is to use the signaling layer as a mailbox / push service, however this is yet to be explored.
Your input would be greatly appreciated.
